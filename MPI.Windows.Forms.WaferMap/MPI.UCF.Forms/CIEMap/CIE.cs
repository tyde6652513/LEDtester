using System;
using System.Collections.Generic;
using System.Text;
using System.Drawing;
using System.Drawing.Drawing2D;
using System.Drawing.Imaging;
using System.Runtime.InteropServices;

namespace MPI.UCF.Forms.Domain
{
	public class CIE
	{
		public enum EChartType
		{
			CIE1931 = 1,
			//CIE1960 = 2,
			CIE1976 = 4,
		}

		[Flags]
		public enum EDrawItem : byte
		{
			CEIChart = 0x01,
			Planckian = 0x02,
			GridLines = 0x04,
			BinRange = 0x08,
			CIExyPoint = 0x10,
			WaveLength = 0x40,
		}

		#region >>> CIE 1931 Spectrum Locus <<<
		/// <summary>
		/// Wavelength: from 360 ~ 700, every 5 locus
		/// </summary>
		internal static readonly PointF[] Locus1931 = 
		{
			new PointF(0.1755602f,0.0052938f), //360
			new PointF(0.1754825f,0.0052863f),
			new PointF(0.1754000f,0.0052786f),
			new PointF(0.1753170f,0.0052710f),
			new PointF(0.1752367f,0.0052635f),
			new PointF(0.1751612f,0.0052563f),  //365
			new PointF(0.1750878f,0.0052468f),
			new PointF(0.1750149f,0.0052356f),
			new PointF(0.1749452f,0.0052262f),
			new PointF(0.1748801f,0.0052208f),
			new PointF(0.1748206f,0.0052206f),
			new PointF(0.1747703f,0.0052287f),
			new PointF(0.1747220f,0.0052375f),
			new PointF(0.1746654f,0.0052362f),
			new PointF(0.1745951f,0.0052183f),
			new PointF(0.1745097f,0.0051816f),
			new PointF(0.1744092f,0.0051268f),
			new PointF(0.1743085f,0.0050676f),
			new PointF(0.1742218f,0.0050170f),
			new PointF(0.1741556f,0.0049814f),
			new PointF(0.1741122f,0.0049637f),
			new PointF(0.1740883f,0.0049636f),
			new PointF(0.1740726f,0.0049725f),
			new PointF(0.1740570f,0.0049820f),
			new PointF(0.1740363f,0.0049860f),
			new PointF(0.1740079f,0.0049805f),
			new PointF(0.1739719f,0.0049641f),
			new PointF(0.1739317f,0.0049434f),
			new PointF(0.1738890f,0.0049260f),
			new PointF(0.1738453f,0.0049161f),
			new PointF(0.1738008f,0.0049154f),
			new PointF(0.1737544f,0.0049249f),
			new PointF(0.1737054f,0.0049371f),
			new PointF(0.1736552f,0.0049438f),
			new PointF(0.1736060f,0.0049399f),
			new PointF(0.1735599f,0.0049232f),
			new PointF(0.1735145f,0.0048954f),
			new PointF(0.1734685f,0.0048646f),
			new PointF(0.1734237f,0.0048363f),
			new PointF(0.1733800f,0.0048133f),
			new PointF(0.1733369f,0.0047967f),
			new PointF(0.1732913f,0.0047858f),
			new PointF(0.1732379f,0.0047789f),
			new PointF(0.1731742f,0.0047751f),
			new PointF(0.1731010f,0.0047740f),
			new PointF(0.1730210f,0.0047751f),
			new PointF(0.1729343f,0.0047811f),
			new PointF(0.1728428f,0.0047908f),
			new PointF(0.1727512f,0.0047988f),
			new PointF(0.1726621f,0.0048021f),
			new PointF(0.1725766f,0.0047993f),
			new PointF(0.1724895f,0.0047953f),
			new PointF(0.1723956f,0.0047961f),
			new PointF(0.1722960f,0.0048026f),
			new PointF(0.1721924f,0.0048149f),
			new PointF(0.1720866f,0.0048325f),
			new PointF(0.1719824f,0.0048550f),
			new PointF(0.1718710f,0.0048885f),
			new PointF(0.1717412f,0.0049393f),
			new PointF(0.1715872f,0.0050103f),
			new PointF(0.1714074f,0.0051022f),
			new PointF(0.1712061f,0.0052113f),
			new PointF(0.1709926f,0.0053339f),
			new PointF(0.1707706f,0.0054701f),
			new PointF(0.1705407f,0.0056210f),
			new PointF(0.1703010f,0.0057885f),
			new PointF(0.1700502f,0.0059739f),
			new PointF(0.1697859f,0.0061768f),
			new PointF(0.1695046f,0.0063980f),
			new PointF(0.1692029f,0.0066387f),
			new PointF(0.1688775f,0.0069002f),
			new PointF(0.1685247f,0.0071840f),
			new PointF(0.1681461f,0.0074907f),
			new PointF(0.1677462f,0.0078208f),
			new PointF(0.1673283f,0.0081754f),
			new PointF(0.1668953f,0.0085556f),
			new PointF(0.1664463f,0.0089644f),
			new PointF(0.1659768f,0.0094017f),
			new PointF(0.1654833f,0.0098647f),
			new PointF(0.1649627f,0.0103507f),
			new PointF(0.1644118f,0.0108576f),
			new PointF(0.1638284f,0.0113849f),
			new PointF(0.1632099f,0.0119374f),
			new PointF(0.1625521f,0.0125200f),
			new PointF(0.1618514f,0.0131373f),
			new PointF(0.1611046f,0.0137934f),
			new PointF(0.1603096f,0.0144914f),
			new PointF(0.1594659f,0.0152321f),
			new PointF(0.1585731f,0.0160152f),
			new PointF(0.1576312f,0.0168399f),
			new PointF(0.1566409f,0.0177048f),
			new PointF(0.1556051f,0.0186086f),
			new PointF(0.1545246f,0.0195557f),
			new PointF(0.1533972f,0.0205537f),
			new PointF(0.1522192f,0.0216117f),
			new PointF(0.1509854f,0.0227402f),
			new PointF(0.1496906f,0.0239503f),
			new PointF(0.1483368f,0.0252474f),
			new PointF(0.1469282f,0.0266352f),
			new PointF(0.1454684f,0.0281184f),
			new PointF(0.1439604f,0.0297030f),
			new PointF(0.1424051f,0.0313936f),
			new PointF(0.1407956f,0.0332132f),
			new PointF(0.1391207f,0.0352006f),
			new PointF(0.1373638f,0.0374031f),
			new PointF(0.1355027f,0.0398791f),
			new PointF(0.1335093f,0.0426924f),
			new PointF(0.1313706f,0.0458760f),
			new PointF(0.1290858f,0.0494498f),
			new PointF(0.1266622f,0.0534259f),
			new PointF(0.1241185f,0.0578025f),
			new PointF(0.1214686f,0.0625877f),
			new PointF(0.1187013f,0.0678304f),
			new PointF(0.1158074f,0.0735807f),
			new PointF(0.1127761f,0.0798958f),
			new PointF(0.1095943f,0.0868425f),
			new PointF(0.1062607f,0.0944861f),
			new PointF(0.1027759f,0.1028637f),
			new PointF(0.0991276f,0.1120070f),
			new PointF(0.0953041f,0.1219449f),
			new PointF(0.0912935f,0.1327020f),
			new PointF(0.0870824f,0.1443166f),
			new PointF(0.0826795f,0.1568660f),
			new PointF(0.0781160f,0.1704205f),
			new PointF(0.0734373f,0.1850319f),
			new PointF(0.0687059f,0.2007232f),
			new PointF(0.0639930f,0.2174676f),
			new PointF(0.0593158f,0.2352537f),
			new PointF(0.0546665f,0.2540956f),
			new PointF(0.0500315f,0.2740018f),
			new PointF(0.0453907f,0.2949760f),
			new PointF(0.0407573f,0.3169811f),
			new PointF(0.0361951f,0.3398999f),
			new PointF(0.0317565f,0.3635977f),
			new PointF(0.0274942f,0.3879213f),
			new PointF(0.0234599f,0.4127035f),
			new PointF(0.0197046f,0.4377559f),
			new PointF(0.0162685f,0.4629545f),
			new PointF(0.0131830f,0.4882071f),
			new PointF(0.0104757f,0.5134042f),
			new PointF(0.0081680f,0.5384231f),
			new PointF(0.0062849f,0.5630685f),
			new PointF(0.0048754f,0.5871164f),
			new PointF(0.0039824f,0.6104475f),
			new PointF(0.0036364f,0.6330114f),
			new PointF(0.0038585f,0.6548232f),
			new PointF(0.0046457f,0.6758985f),
			new PointF(0.0060109f,0.6961201f),
			new PointF(0.0079884f,0.7153415f),
			new PointF(0.0106033f,0.7334129f),
			new PointF(0.0138702f,0.7501864f),
			new PointF(0.0177661f,0.7656122f),
			new PointF(0.0222442f,0.7796299f),
			new PointF(0.0272733f,0.7921035f),
			new PointF(0.0328204f,0.8029257f),
			new PointF(0.0388518f,0.8120160f),
			new PointF(0.0453280f,0.8193908f),
			new PointF(0.0521767f,0.8251635f),
			new PointF(0.0593255f,0.8294258f),
			new PointF(0.0667159f,0.8322737f),
			new PointF(0.0743024f,0.8338031f),
			new PointF(0.0820534f,0.8340903f),
			new PointF(0.0899417f,0.8332889f),
			new PointF(0.0979398f,0.8315927f),
			new PointF(0.1060211f,0.8291782f),
			new PointF(0.1141607f,0.8262070f),
			new PointF(0.1223474f,0.8227704f),
			new PointF(0.1305457f,0.8189279f),
			new PointF(0.1387023f,0.8147744f),
			new PointF(0.1467732f,0.8103946f),
			new PointF(0.1547221f,0.8058635f),
			new PointF(0.1625354f,0.8012385f),
			new PointF(0.1702372f,0.7965185f),
			new PointF(0.1778495f,0.7916866f),
			new PointF(0.1853908f,0.7867278f),
			new PointF(0.1928761f,0.7816292f),
			new PointF(0.2003088f,0.7763994f),
			new PointF(0.2076900f,0.7710548f),
			new PointF(0.2150296f,0.7655951f),
			new PointF(0.2223366f,0.7600200f),
			new PointF(0.2296197f,0.7543291f),
			new PointF(0.2368847f,0.7485245f),
			new PointF(0.2441326f,0.7426140f),
			new PointF(0.2513634f,0.7366056f),
			new PointF(0.2585775f,0.7305066f),
			new PointF(0.2657751f,0.7243239f),
			new PointF(0.2729576f,0.7180622f),
			new PointF(0.2801289f,0.7117247f),
			new PointF(0.2872924f,0.7053163f),
			new PointF(0.2944503f,0.6988420f),
			new PointF(0.3016038f,0.6923078f),
			new PointF(0.3087599f,0.6857121f),
			new PointF(0.3159144f,0.6790635f),
			new PointF(0.3230663f,0.6723674f),
			new PointF(0.3302155f,0.6656280f),
			new PointF(0.3373633f,0.6588483f),
			new PointF(0.3445132f,0.6520282f),
			new PointF(0.3516644f,0.6451722f),
			new PointF(0.3588137f,0.6382873f),
			new PointF(0.3659594f,0.6313791f),
			new PointF(0.3731015f,0.6244509f),
			new PointF(0.3802438f,0.6175022f),
			new PointF(0.3873790f,0.6105418f),
			new PointF(0.3945065f,0.6035713f),
			new PointF(0.4016259f,0.5965924f),
			new PointF(0.4087363f,0.5896069f),
			new PointF(0.4158358f,0.5826180f),
			new PointF(0.4229209f,0.5756307f),
			new PointF(0.4299886f,0.5686489f),
			new PointF(0.4370364f,0.5616758f),
			new PointF(0.4440625f,0.5547139f),
			new PointF(0.4510649f,0.5477660f),
			new PointF(0.4580407f,0.5408366f),
			new PointF(0.4649863f,0.5339301f),
			new PointF(0.4718987f,0.5270506f),
			new PointF(0.4787748f,0.5202023f),
			new PointF(0.4856116f,0.5133887f),
			new PointF(0.4924050f,0.5066149f),
			new PointF(0.4991507f,0.4998873f),
			new PointF(0.5058453f,0.4932112f),
			new PointF(0.5124864f,0.4865908f),
			new PointF(0.5190725f,0.4800286f),
			new PointF(0.5256005f,0.4735274f),
			new PointF(0.5320656f,0.4670914f),
			new PointF(0.5384628f,0.4607253f),
			new PointF(0.5447865f,0.4544341f),
			new PointF(0.5510311f,0.4482245f),
			new PointF(0.5571929f,0.4420991f),
			new PointF(0.5632693f,0.4360581f),
			new PointF(0.5692568f,0.4301020f),
			new PointF(0.5751513f,0.4242322f),
			new PointF(0.5809526f,0.4184469f),
			new PointF(0.5866502f,0.4127584f),
			new PointF(0.5922248f,0.4071895f),
			new PointF(0.5976582f,0.4017619f),
			new PointF(0.6029328f,0.3964966f),
			new PointF(0.6080351f,0.3914092f),
			new PointF(0.6129770f,0.3864862f),
			new PointF(0.6177787f,0.3817058f),
			new PointF(0.6224593f,0.3770473f),
			new PointF(0.6270366f,0.3724911f),
			new PointF(0.6315209f,0.3680260f),
			new PointF(0.6358998f,0.3636654f),
			new PointF(0.6401562f,0.3594277f),
			new PointF(0.6442730f,0.3553314f),
			new PointF(0.6482331f,0.3513949f),
			new PointF(0.6520282f,0.3476280f),
			new PointF(0.6556692f,0.3440183f),
			new PointF(0.6591661f,0.3405532f),
			new PointF(0.6625282f,0.3372210f),
			new PointF(0.6657636f,0.3340107f),
			new PointF(0.6688741f,0.3309186f),
			new PointF(0.6718587f,0.3279471f),
			new PointF(0.6747195f,0.3250952f),
			new PointF(0.6774589f,0.3223621f),
			new PointF(0.6800789f,0.3197472f),
			new PointF(0.6825816f,0.3172487f),
			new PointF(0.6849706f,0.3148628f),
			new PointF(0.6872505f,0.3125860f),
			new PointF(0.6894263f,0.3104140f),
			new PointF(0.6915040f,0.3083423f),
			new PointF(0.6934896f,0.3063657f),
			new PointF(0.6953886f,0.3044786f),
			new PointF(0.6972056f,0.3026751f),
			new PointF(0.6989439f,0.3009504f),
			new PointF(0.7006061f,0.2993007f),
			new PointF(0.7021926f,0.2977245f),
			new PointF(0.7037087f,0.2962171f),
			new PointF(0.7051629f,0.2947703f),
			new PointF(0.7065632f,0.2933762f),
			new PointF(0.7079178f,0.2920271f),
			new PointF(0.7092310f,0.2907186f),
			new PointF(0.7105004f,0.2894529f),
			new PointF(0.7117241f,0.2882321f),
			new PointF(0.7129012f,0.2870573f),
			new PointF(0.7140316f,0.2859289f),
			new PointF(0.7151171f,0.2848451f),
			new PointF(0.7161592f,0.2838044f),
			new PointF(0.7171586f,0.2828064f),
			new PointF(0.7181161f,0.2818503f),
			new PointF(0.7190329f,0.2809350f),
			new PointF(0.7199116f,0.2800581f),
			new PointF(0.7207527f,0.2792190f),
			new PointF(0.7215545f,0.2784195f),
			new PointF(0.7223149f,0.2776619f),
			new PointF(0.7230316f,0.2769484f),
			new PointF(0.7237019f,0.2762818f),
			new PointF(0.7243280f,0.2756601f),
			new PointF(0.7249144f,0.2750782f),
			new PointF(0.7254668f,0.2745300f),
			new PointF(0.7259923f,0.2740077f),
			new PointF(0.7264947f,0.2735053f),
			new PointF(0.7269750f,0.2730250f),
			new PointF(0.7274318f,0.2725682f),
			new PointF(0.7278643f,0.2721357f),
			new PointF(0.7282717f,0.2717283f),
			new PointF(0.7286565f,0.2713435f),
			new PointF(0.7290200f,0.2709800f),
			new PointF(0.7293610f,0.2706390f),
			new PointF(0.7296778f,0.2703222f),
			new PointF(0.7299690f,0.2700310f),
			new PointF(0.7302339f,0.2697661f),
			new PointF(0.7304742f,0.2695258f),
			new PointF(0.7306933f,0.2693067f),
			new PointF(0.7308963f,0.2691037f),
			new PointF(0.7310894f,0.2689106f),
			new PointF(0.7312796f,0.2687204f),
			new PointF(0.7314671f,0.2685329f),
			new PointF(0.7316500f,0.2683500f),
			new PointF(0.7318263f,0.2681737f),
			new PointF(0.7319933f,0.2680067f),
			new PointF(0.7321504f,0.2678496f),
			new PointF(0.7322998f,0.2677002f),
			new PointF(0.7324428f,0.2675572f),
			new PointF(0.7325815f,0.2674185f),
			new PointF(0.7327189f,0.2672811f),
			new PointF(0.7328586f,0.2671414f),
			new PointF(0.7330002f,0.2669998f),
			new PointF(0.7331417f,0.2668583f),
			new PointF(0.7332812f,0.2667188f),
			new PointF(0.7334170f,0.2665830f),
			new PointF(0.7335506f,0.2664494f),
			new PointF(0.7336833f,0.2663167f),
			new PointF(0.7338127f,0.2661873f),
			new PointF(0.7339357f,0.2660643f),
			new PointF(0.7340473f,0.2659527f),
			new PointF(0.7341426f,0.2658574f),
			new PointF(0.7342215f,0.2657785f),
			new PointF(0.7342864f,0.2657136f),
			new PointF(0.7343409f,0.2656591f),
			new PointF(0.7343902f,0.2656098f),
			new PointF(0.7344377f,0.2655623f),
			new PointF(0.7344822f,0.2655178f),
			new PointF(0.7345229f,0.2654771f),
			new PointF(0.7345595f,0.2654405f),
			new PointF(0.7345917f,0.2654083f), //695
			new PointF(0.7346211f,0.2653789f),
			new PointF(0.7346489f,0.2653511f),
			new PointF(0.7346734f,0.2653266f),
			new PointF(0.7346898f,0.2653102f),
			new PointF(0.7346899f,0.2653101f), //700
		};
		#endregion

		#region >>> CIE 1931 Planckian Locus <<<
		internal static PointF[] Planckian1931 = 
		{
         new PointF(0.239870f, 0.234040f),	new PointF(0.242580f, 0.238020f),
         new PointF(0.245600f, 0.242400f),	new PointF(0.248900f, 0.247140f),
         new PointF(0.252510f, 0.252220f),	new PointF(0.256450f, 0.257630f),
         new PointF(0.260700f, 0.263330f),	new PointF(0.265260f, 0.269300f),
         new PointF(0.270110f, 0.275470f),	new PointF(0.275240f, 0.281820f),
         new PointF(0.280630f, 0.288280f),	new PointF(0.295180f, 0.304770f),
         new PointF(0.311010f, 0.321160f),	new PointF(0.327750f, 0.336900f),
         new PointF(0.345100f, 0.351620f),	new PointF(0.362760f, 0.364960f),
         new PointF(0.380450f, 0.376760f),	new PointF(0.397920f, 0.386900f),
         new PointF(0.415020f, 0.395350f),	new PointF(0.431560f, 0.402160f),
         new PointF(0.447460f, 0.407420f),	new PointF(0.462620f, 0.411210f),
         new PointF(0.477010f, 0.413680f),	new PointF(0.490590f, 0.414980f),
         new PointF(0.503380f, 0.415250f),	new PointF(0.515410f, 0.414650f),
         new PointF(0.526690f, 0.413310f),	new PointF(0.537230f, 0.411310f),
         new PointF(0.547120f, 0.408820f),	new PointF(0.556400f, 0.405930f),
         new PointF(0.565080f, 0.402710f)
		};

		#endregion

		internal static readonly short[] WavelengthLocus1931 = new short[] 
		{
			380,	400,	470,	475,	480,
			485,	490,	495,	500,	505,
			510,	515,	520,	525,	530,
			535,	540,	545,	550,	555,
			560,	565,	570,	575,	580,
			585,	590,	595,	600,	605,
			610,	615,	620,	635,	700,
		};

	}
}
